(()=>{var I=Object.create;var A=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty;var j=(t,e)=>()=>(t&&(e=t(t=0)),e);var k=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var K=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of _(e))!W.call(t,o)&&o!==n&&A(t,o,{get:()=>e[o],enumerable:!(r=R(e,o))||r.enumerable});return t};var p=(t,e,n)=>(n=t!=null?I(N(t)):{},K(e||!t||!t.__esModule?A(n,"default",{value:t,enumerable:!0}):n,t));function u(t){return(...e)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${t}`])return window["@Neos:HostPluginAPI"][`@${t}`](...e);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var d=j(()=>{});var m=k((ut,L)=>{d();L.exports=u("vendor")().React});var b=k((ft,x)=>{d();x.exports=u("NeosProjectPackages")().ReactUiComponents});d();var w=u("manifest");var a=p(m()),C=p(b());var P=t=>{if(!("linkAttributes"in t)||!t.linkAttributes||typeof t.linkAttributes!="object"||Array.isArray(t.linkAttributes))return[];let e=[];return Object.keys(t.linkAttributes).forEach(n=>{let r=t.linkAttributes[n];if(!r)return;if(typeof r=="string")return e.push({attribute:n,label:r});if(typeof r!="object"||Array.isArray(r)||!("label"in r&&typeof r.label=="string"))return;let o="help"in r&&typeof r.help=="string"?r.help:void 0,i="placeholder"in r&&typeof r.placeholder=="string"?r.placeholder:void 0;return e.push({attribute:n,label:r.label,help:o,placeholder:i})}),e};var l=p(m()),f=p(b()),E=({inputId:t,option:e,i18nRegistry:n})=>{let[r,o]=(0,l.useState)(!1),i=()=>o(s=>!s);return l.default.createElement("div",null,l.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.default.createElement(f.Label,{htmlFor:t},n.translate(e.label)),e.help&&l.default.createElement("span",{role:"button",onClick:i},l.default.createElement(f.Icon,{icon:"question-circle"}))),e.help&&r&&l.default.createElement(f.Tooltip,{renderInline:!0},n.translate(e.help)))};var y=t=>t.reduce((e,[n,r])=>(e[n]=r,e),{});var F={display:"flex",padding:8,gap:8,flexWrap:"wrap"},S=t=>{let[e,n]=(0,a.useState)({}),r=(0,a.useMemo)(()=>P(t.linkingOptions),[t.linkingOptions]);(0,a.useEffect)(()=>{try{let i=new URL(t.linkValue);i.search&&(i.searchParams,n(y(r.map(s=>[s.attribute,i.searchParams.get(s.attribute)??""]))))}catch{n(y(r.map(s=>[s.attribute,""])))}},[t.linkValue,r]);let o=(0,a.useCallback)(i=>s=>{n(c=>{let v={...c,[i]:s};try{let g=new URL(t.linkValue),h=g.searchParams;s.length===0&&h.has(i)?h.delete(i):h.set(i,s),t.onLinkChange(g.toString())}catch{}return v})},[t.linkValue,t.onLinkChange]);return a.default.createElement("div",{style:F},r.map((i,s)=>{let c=`link-attribute-input-${s}`;return a.default.createElement("div",{key:i.attribute},a.default.createElement(E,{option:i,inputId:c,i18nRegistry:t.i18nRegistry}),a.default.createElement(C.TextInput,{id:c,value:e[i.attribute],onChange:o(i.attribute),placeholder:t.i18nRegistry.translate(i.placeholder)}))}))};w("Prgfx.Neos.LinkEditor:LinkEditor",{},t=>{t.get("containers").set("LinkInput/OptionsPanel/LinkAttributeEditor",S,"end");let n=t.get("dataLoaders").get("LinkLookup"),r=n.resolveValue,o=(i,s)=>{let c=typeof s=="string"&&/^node:\/\//.test(s)?s.split("?")[0]:s;return r.call(n,i,c)};n.resolveValue=o.bind(n)});})();
