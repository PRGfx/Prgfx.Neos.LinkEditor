(()=>{var $=Object.create;var L=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(t&&(e=t(t=0)),e);var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var X=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Y(e))!J.call(t,o)&&o!==n&&L(t,o,{get:()=>e[o],enumerable:!(r=z(e,o))||r.enumerable});return t};var g=(t,e,n)=>(n=t!=null?$(q(t)):{},X(e||!t||!t.__esModule?L(n,"default",{value:t,enumerable:!0}):n,t));function p(t){return(...e)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${t}`])return window["@Neos:HostPluginAPI"][`@${t}`](...e);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var m=Q(()=>{});var h=x((St,S)=>{m();S.exports=p("vendor")().React});var C=x((jt,_)=>{m();_.exports=p("NeosProjectPackages")().ReactUiComponents});var K=x((Ut,V)=>{m();V.exports=p("NeosProjectPackages")().NeosUiDecorators});m();var v=p("manifest");var l=g(h());var I=t=>{let e={};return!t||typeof t!="object"||Array.isArray(t)||Object.entries(t).forEach(([n,r])=>{if(!r||typeof r!="object"||Array.isArray(r)||!("label"in r)||typeof r.label!="string")return;let o="collapsed"in r&&r.collapsed===!0;e[n]={key:n,label:r.label,collapsed:o}}),e},E="default",N=t=>{if(!("linkAttributes"in t)||!t.linkAttributes||typeof t.linkAttributes!="object"||Array.isArray(t.linkAttributes))return[];let e=[];return Object.keys(t.linkAttributes).forEach(n=>{let r=t.linkAttributes[n];if(!r)return;if(typeof r=="string")return e.push({attribute:n,label:r,group:E});if(typeof r!="object"||Array.isArray(r)||!("label"in r&&typeof r.label=="string"))return;let o="help"in r&&typeof r.help=="string"?r.help:void 0,u="placeholder"in r&&typeof r.placeholder=="string"?r.placeholder:void 0,i="group"in r&&typeof r.group=="string"?r.group:E;return e.push({attribute:n,label:r.label,help:o,placeholder:u,group:i})}),e},j=t=>{let e=t.reduce((n,r)=>({...n,[r.group]:[...n[r.group]??[],r]}),{});return Object.entries(e)};var w=t=>t.reduce((e,[n,r])=>(e[n]=r,e),{});var a=g(h());var f=g(h()),d=g(C()),W=({inputId:t,option:e,i18nRegistry:n})=>{let[r,o]=(0,f.useState)(!1),u=()=>o(i=>!i);return f.default.createElement("div",null,f.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},f.default.createElement(d.Label,{htmlFor:t},n.translate(e.label)),e.help&&f.default.createElement("span",{role:"button",onClick:u},f.default.createElement(d.Icon,{icon:"question-circle"}))),e.help&&r&&f.default.createElement(d.Tooltip,{renderInline:!0},n.translate(e.help)))};var A=g(C());var tt=0,P=()=>`prgfx-le-id${++tt}`;var et={padding:8,border:0,margin:0,position:"relative",width:"100%"},rt={display:"block",top:8,marginBottom:8,position:"relative"},nt={position:"absolute",top:"-3ch",right:0},it=t=>({display:t?"none":"flex",flexWrap:"wrap",gap:8}),F=t=>t.collapsed===!0&&t.options.every(({attribute:e})=>!(e in t.values)||t.values[e]===""),G=t=>{let[e,n]=(0,a.useState)(F(t)),r=(0,a.useRef)(!1),o=P(),u=P();return(0,a.useEffect)(()=>{r.current||Object.keys(t.values).length>0&&(n(F(t)),r.current=!0)},[t.values]),a.default.createElement("fieldset",{style:et},a.default.createElement("legend",{style:rt,id:o},t.i18nRegistry.translate(t.label)),a.default.createElement("div",{style:nt},a.default.createElement(A.IconButton,{icon:e?"chevron-circle-down":"chevron-circle-up",onClick:()=>n(i=>!i),style:"transparent",size:"small","aria-expanded":!e,"aria-controls":u,"aria-labelledby":o})),a.default.createElement("div",{style:it(e),id:u},t.options.map((i,b)=>{let y=`link-attribute-input-${b}`;return a.default.createElement("div",{key:i.attribute},a.default.createElement(W,{option:i,inputId:y,i18nRegistry:t.i18nRegistry}),a.default.createElement(A.TextInput,{id:y,value:t.values[i.attribute],onChange:t.onChange(i.attribute),placeholder:t.i18nRegistry.translate(i.placeholder)}))})))};var U=g(h()),M=g(K()),T=()=>(0,U.useContext)(M.NeosContext);var H=t=>{let{onLinkChange:e}=t,{globalRegistry:n}=T(),r=(0,l.useMemo)(()=>{let s=n.get("frontendConfiguration").get("Prgfx.Neos.LinkEditor");return I(s.groups)},[n]),[o,u]=(0,l.useState)({}),i=(0,l.useMemo)(()=>N(t.linkingOptions),[t.linkingOptions]),b=(0,l.useMemo)(()=>j(i).filter(([s])=>s in r),[i,r]);(0,l.useEffect)(()=>{try{let s=new URL(t.linkValue);s.search&&(s.searchParams,u(w(i.map(c=>[c.attribute,s.searchParams.get(c.attribute)??""]))))}catch{u(w(i.map(c=>[c.attribute,""])))}},[t.linkValue,i]);let y=(0,l.useCallback)(s=>c=>{u(D=>{let B={...D,[s]:c};try{let k=new URL(t.linkValue),O=k.searchParams;c.length===0&&O.has(s)?O.delete(s):O.set(s,c),e(k.toString())}catch{}return B})},[t.linkValue,e]);return l.default.createElement(l.default.Fragment,null,b.map(([s,c])=>l.default.createElement(G,{key:s,label:r[s].label,i18nRegistry:t.i18nRegistry,options:c,onChange:y,values:o,collapsed:r[s].collapsed})))};v("Prgfx.Neos.LinkEditor:LinkEditor",{},t=>{t.get("containers").set("LinkInput/OptionsPanel/LinkAttributeEditor",H,"end");let n=t.get("dataLoaders").get("LinkLookup"),r=n.resolveValue,o=(u,i)=>{let b=typeof i=="string"&&/^node:\/\//.test(i)?i.split("?")[0]:i;return r.call(n,u,b)};n.resolveValue=o.bind(n)});})();
